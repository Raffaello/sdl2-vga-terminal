# branches to build
branches:
  # whitelist
  only:
    - master

skip_branch_with_pr: false

image: Visual Studio 2019

platform:
  - x86
  - x64

configuration:
  - Release
  - Debug

matrix:
  fast_finish: true

for:
-
    matrix:
        only:
            - configuration: x64
    init:
        - call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"
-
    matrix:
        only:
            - configuration: x86
    init:
        - call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars32.bat"

           
install:
    - cd C:\tools\vcpkg
    - git pull
    - .\bootstrap-vcpkg.bat
    - vcpkg install sdl2 sdl2-image gtest --triplet x64-windows
    - vcpkg install sdl2 sdl2-image gtest --triplet x86-windows
    - vcpkg integrate install
    - cd %APPVEYOR_BUILD_FOLDER%


cache: c:\tools\vcpkg\installed\

build_script:
    - cmake -DCMAKE_TOOLCHAIN_FILE=c:/tools/vcpkg/scripts/buildsystems/vcpkg.cmake . -DCMAKE_BUILD_TYPE=%CONFIGURATION%

test_script:
    - cmake .
    - ctest