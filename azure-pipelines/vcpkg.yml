trigger:
  branches:
    include:
    - master
  paths:
    exclude:
    #- .gitignore
    - .github/*
    - README.md
    - appveyor.yml
  tags:
    include:
    - '*'

pr:
  branches:
    include:
    - master
  paths:
    exclude:
    #- .gitignore
    - .github/*
    - README.md
    - appveyor.yml
    - LICENSE

variables:
  - template: variables/global.yml
  - template: variables/images.yml
  - template: variables/build_switches.yml

stages:
- stage: Dep
  jobs:
    - job: vcpkg
      strategy:
        matrix:
          osx:
            imageName: ${{ variables.mac_image }}
            TRIPLET: x64-osx
      pool:
        vmImage: $(imageName)
      steps:
      - template: templates/dep-vcpkg-steps.yml
        parameters:
          vcpkg_key_cache: $(CACHE_VCPKG_KEY)
          triplet: $(TRIPLET)
          arch: $(ARCH)
      # - task: CopyFiles@2
      #   inputs:
      #     contents: '$(Build.SourcesDirectory)/vcpkg'
      #     targetFolder: $(Build.ArtifactStagingDirectory)
      - publish: '$(Build.SourcesDirectory)/vcpkg'
        artifact: dep-vcpkg
